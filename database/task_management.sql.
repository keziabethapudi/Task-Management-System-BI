-- 1. Create the Database Schema
CREATE TABLE Users (
    user_id INTEGER PRIMARY KEY,
    username TEXT NOT NULL,
    email TEXT UNIQUE,
    department TEXT
);

CREATE TABLE Tasks (
    task_id INTEGER PRIMARY KEY,
    user_id INTEGER,
    task_name TEXT NOT NULL,
    priority TEXT CHECK(priority IN ('High', 'Medium', 'Low')),
    status TEXT CHECK(status IN ('Completed', 'Pending', 'In Progress')),
    deadline DATE,
    FOREIGN KEY (user_id) REFERENCES Users(user_id)
);

-- 2. Insert Sample Data for Analysis
INSERT INTO Users VALUES (1, 'Kezia', 'keziabethapudi1626@gmail.com', 'IT');
INSERT INTO Users VALUES (2, 'Rahul', 'rahul@example.com', 'Data Science');

INSERT INTO Tasks VALUES (101, 1, 'Build Weather App', 'High', 'Completed', '2026-02-20');
INSERT INTO Tasks VALUES (102, 1, 'Setup SQL Portfolio', 'High', 'In Progress', '2026-02-28');
INSERT INTO Tasks VALUES (103, 2, 'Data Cleaning Project', 'Medium', 'Pending', '2026-03-05');

-- 3. Business Intelligence Query: Track Productivity
-- This query shows how many tasks are pending per user.
SELECT 
    u.username, 
    COUNT(t.task_id) AS total_pending_tasks
FROM Users u
JOIN Tasks t ON u.user_id = t.user_id
WHERE t.status != 'Completed'
GROUP BY u.username;
